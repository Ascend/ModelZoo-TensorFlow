WARNING:tensorflow:From /home/HwHiAiUser/wubo/vit/vit-ckpt/precision_tool/tf_config.py:25: The name tf.random.set_random_seed is deprecated. Please use tf.compat.v1.random.set_random_seed instead.

WARNING:tensorflow:From /usr/local/Ascend/tfplugin/latest/tfplugin/python/site-packages/npu_bridge/estimator/npu/npu_optimizer.py:127: The name tf.train.Optimizer is deprecated. Please use tf.compat.v1.train.Optimizer instead.

WARNING:tensorflow:From /usr/local/python3.7.5/lib/python3.7/site-packages/tensorflow_core/python/ops/resource_variable_ops.py:1630: calling BaseResourceVariable.__init__ (from tensorflow.python.ops.resource_variable_ops) with constraint is deprecated and will be removed in a future version.
Instructions for updating:
If using Keras pass *_constraint arguments to layers.
WARNING:tensorflow:From /usr/local/python3.7.5/lib/python3.7/site-packages/tensorflow_core/python/data/util/random_seed.py:58: where (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
WARNING:tensorflow:From ./vit_allpipeline_fusion_accelerate.py:124: The name tf.train.MomentumOptimizer is deprecated. Please use tf.compat.v1.train.MomentumOptimizer instead.

WARNING:tensorflow:From /usr/local/Ascend/tfplugin/latest/tfplugin/python/site-packages/npu_bridge/estimator/npu/npu_loss_scale_optimizer.py:58: The name tf.get_default_graph is deprecated. Please use tf.compat.v1.get_default_graph instead.

WARNING:tensorflow:From ./vit_allpipeline_fusion_accelerate.py:142: The name tf.ConfigProto is deprecated. Please use tf.compat.v1.ConfigProto instead.

WARNING:tensorflow:From ./vit_allpipeline_fusion_accelerate.py:156: The name tf.Session is deprecated. Please use tf.compat.v1.Session instead.

2022-05-15 09:48:43.822834: W tensorflow/core/platform/profile_utils/cpu_utils.cc:98] Failed to find bogomips in /proc/cpuinfo; cannot determine CPU frequency
2022-05-15 09:48:43.828896: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x458aa510 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2022-05-15 09:48:43.828943: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
WARNING:tensorflow:From ./vit_allpipeline_fusion_accelerate.py:157: The name tf.global_variables_initializer is deprecated. Please use tf.compat.v1.global_variables_initializer instead.

[PrecisionTool] Set Tensorflow random seed to 0 success.
[PrecisionTool] Set numpy random seed to 0 success.
load dataset =================================
load dataset =================================
[PrecisionTool] Set fusion switch file:  /home/HwHiAiUser/wubo/vit/vit-ckpt/precision_tool/fusion_off.cfg
2022-05-15 09:48:53.112488: I /home/phisik3/jenkins/workspace/work_code/tmp/host-prefix/src/host-build/asl/tfadaptor/CMakeFiles/tf_adapter.dir/compiler_depend.ts:805] The model has been compiled on the Ascend AI processor, current graph id is: 1
WARNING:tensorflow:From ./vit_allpipeline_fusion_accelerate.py:160: The name tf.train.Saver is deprecated. Please use tf.compat.v1.train.Saver instead.

2022-05-15 09:49:04.981514: I /home/phisik3/jenkins/workspace/work_code/tmp/host-prefix/src/host-build/asl/tfadaptor/CMakeFiles/tf_adapter.dir/compiler_depend.ts:805] The model has been compiled on the Ascend AI processor, current graph id is: 11
2022-05-15 09:49:25.298880: I /home/phisik3/jenkins/workspace/work_code/tmp/host-prefix/src/host-build/asl/tfadaptor/CMakeFiles/tf_adapter.dir/compiler_depend.ts:805] The model has been compiled on the Ascend AI processor, current graph id is: 21
2022-05-15 09:53:30.029074: I /home/phisik3/jenkins/workspace/work_code/tmp/host-prefix/src/host-build/asl/tfadaptor/CMakeFiles/tf_adapter.dir/compiler_depend.ts:805] The model has been compiled on the Ascend AI processor, current graph id is: 31
============ start load pretrained model =======================================
============ load success 6.5804 =====================
epoch:1  step: 0 , loss:  0.0681 ,  time: 113.6311  acc: 1.0000
epoch:1  step: 1 , loss:  0.2198 ,  time: 15.5381  acc: 0.7500
epoch:1  step: 2 , loss:  0.0095 ,  time: 15.2189  acc: 1.0000
epoch:1  step: 3 , loss:  0.0476 ,  time: 22.9079  acc: 1.0000
epoch:1  step: 4 , loss:  0.0578 ,  time: 15.2788  acc: 1.0000
epoch:1  step: 5 , loss:  0.6772 ,  time: 15.5429  acc: 0.7500
epoch:1  step: 6 , loss:  0.0049 ,  time: 15.0698  acc: 1.0000
epoch:1  step: 7 , loss:  0.1065 ,  time: 15.2203  acc: 1.0000
epoch:1  step: 8 , loss:  0.1218 ,  time: 15.2791  acc: 1.0000
epoch:1  step: 9 , loss:  0.0144 ,  time: 15.3114  acc: 1.0000
Train ACC: 0.9500
Final Average Distances : 0.871
